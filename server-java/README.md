## 프로젝트

## Getting Started

### Prerequisites

#### Running Docker Containers

`local` profile 로 실행하기 위하여 인프라가 설정되어 있는 Docker 컨테이너를 실행해주셔야 합니다.

```bash
docker-compose up -d
```

# e-commerce prj

## 아키텍처 

### 기능적 요구사항
- 상품조회 api
- 주문생성
- 결제실행
- 포인트 조회 / 충전

### 비기능적 요구사항


### 요구사항 명세서 
- 필수
 - [ ] 상품조회 API  
 - [ ] 주문생성 API
 - [ ] 결제실행 API
 - [ ] 포인트조회 API
 - [ ] 포인트충전 API

- 추가기능
 - [ ] 결제조회 API
 - [ ] 환불실행 API
 - [ ] 유저 로그인 API
 - [ ] 유저생성 API

- 심화(선택) 

 - [ ] 쿠폰생성 API
 - [ ] 쿠폰조회 API
 - [ ] 인기상품조회 API

#### ADR (Architecture Decision Record) = 아키텍처 의사결정 기록

**요구 사항 분석**

`상품조회`
기능: 상품을 조회한다. 
조건
  1. 상품을 조회하기 위해 , 상품생성이 필요하다.
  2. 이름, 가격 , 상태 , 생성일 , 수량을 갖는다. 
  3. 수량에 대한 동시성 처리가 가능 해야한다. 

`주문조회`
기능: 주문을 생성한다. 
조건: 
  1. 주문은 상품와 관계가 존재한다. 
  2. 주문은 주문리스트를 갖는다.
  3. 생성한 주문을 조회 할 수 있어야 한다. 

`결제조회`
기능: 결제를 실행한다.
조건: 
  1. 결제는 주문와 관계가 존재한다. 
  2. 결제는 여러가지 다른 관계가 올수도 있다. 
  3. 결제조회가 가능해야한다. 
  4. 결제취소가 가능해야한다.

`포인트조회`
기능: 포인트을 조회한다. 
조건: 
  1. 포인트는 유저와 1:1 관계를 갖는다. 
  2. 특정 유저의 포인트를 조회한다.

`포인트생성`
기능: 포인트을 생성한다. 
조건: 
  1. 포인트는 유저와 1:1 관계를 갖는다. 
  2. 생성한 포인트가 특정 유저에 포인트 금액 관리가 되어야한다. 


요구사항 분석을 통해 추가해야할 API 

 - 결제조회 API
 - 환불실행 API
 - 유저 로그인 API
 - 유저생성 API
 - 유저생성 API
 - 유저생성 API


`쿠폰생성`
기능: 쿠폰을 생성한다. 
조건
  1. 쿠폰은 유저와 관계를 갖는다. 
  2. 선착순 쿠폰. 등 특별한 상태 일 수있다.
  3. 만약에 쿠폰의 적용이 상품별로 다를 수있다면, 상품과도 관계를 갖는다. 그리고 별도의 도메인이다.

`쿠폰조회`
기능: 쿠폰을 조회한다. 
조건
  1. 쿠폰 수량에 대한 동시성 처리가 가능해야한다. 
  2. 선착순 쿠폰이면, 여러 유저의 동시성 접근에 대한 처리가 가능해야한다. 

`인기상품조회`
기능: 인기상품을 조회한다. 
조건
  1. 인기 상품 조회 한다.
  2. 인기 상품에 대한 조건을 설계한다. 
  3. 인기 상품은 주문수량, 결제진행 상황, 등을 고려해 요일별 , 주별 다양한 조건이 설정 될수 있다. 
  4. 인기 상품은 배치가 돌수도 있다. 


---
**애플리케이션 구조**
- 결정 : 
  - DDD 사용
- 이유 : 
  - Domain 객체의 책임과 역할에 대해서 공부 해보며 , 연습을 위해서
  - 누가 보든 한번에 이해하기 쉽게 하기 위함인데 , 여기엔 AI도 포함


---
**ERD 구조**

결정
1. 테이블과 application Layer( Entity Object ) 와 1:1 매핑 되도록 설계한다. 
2. DB는 단일 디비임을 가정하고 설계한다. 설계의 기본요구사항은 직접참조이다.
 - 테이블은 집합관계(Aggregation)을 이룬다. ex) 주문, 주문아이템
 - 테이블은 간접관계(ID 참조) 이룬다. ex) 주문아이템, 상품
   - 간접관계를 가지는 원리는 단독으로 사용가능하면 간접관계를 설정한다. 
3. 재고 수량에 대한 책임은 Product가 책임진다. ( 추후 요구사항 변경으로 달라질 수 있다.)
4. 금액 계산의 책임은 Order(바운더리)가 책임진다. ( 추후 요구사항 변경으로 달라질 수 있다. )
 - 쿠폰 , 포인트를 계산해야함으로
 - 결제 단계에서는 Order의 계산 내용을 신뢰한다. 
5. 유저의 속성에서 포인트를 간단하게 사용할수있지만, 다양한 포인트가 올 수 잇음을 고려해서 테이블(도메인) 분리


제약조건
- `Product.price >= 0`
- `Product.stock >= 0`
- `Order.total_amount > 0`
- `Order.final_amount > 0`
- `Order.paid_amount >= 0`
- `OrderItem.quantity >= 1`
- `Payment.amount > 0`
- `Point.balance >= 0`

---
**Infra 구조**







